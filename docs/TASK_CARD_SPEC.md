# taskカード仕様

## taskカードのモード
1.  **通常モード (Normal)**: デフォルトの状態。
2.  **選択モード (Selected)**: カードがフォーカスされている状態。アクセントカラーの枠線が表示される。
3.  **編集モード (Editing)**: 既存タスクのテキストを編集している状態。
4.  **追加モード (Adding)**: 新しいタスクを入力している状態。

## taskカードのHTML要素

```html
<!-- 共通構造 -->
<div class="weekly-report-task-row [is-selected | is-editing | is-adding]">
  <!-- インデントガイド (階層分だけ繰り返し) -->
  <div class="task-indent-guide [is-vertical | is-tee | is-corner]"></div>
  ...

  <!-- カード本体 (border, background, paddingを持つ) -->
  <div class="task-card" style="position: relative; z-index: 1;">
    <!-- チェックボックスセル -->
    <div class="task-cell task-check-cell">
      <input type="checkbox" class="weekly-report-task-checkbox" />
    </div>

    <!-- タイトルセル -->
    <div class="task-cell task-title-cell">
      <!-- 【通常・選択モード】 テキスト表示 -->
      <span class="task-content-text [is-checked]">タスク内容</span>
      <!-- 【編集・追加モード】 編集ラッパー -->
      <div class="task-edit-wrapper">
         <input type="text" class="task-edit-input" />
         <div class="task-edit-buttons">
           <button class="task-edit-save">✓</button>
           <button class="task-edit-cancel">✕</button>
         </div>
      </div>
    </div>
    
    <!-- 【選択モードのみ】 アクションボタン -->
    <div class="task-edit-btn">✎</div>
    <div class="task-delete-btn">🗑</div>
  </div>
</div>
```

## カーソル（マウス）操作による挙動

### 共通
- **チェックボックスをクリック**:
  - チェック状態のトグル（完了/未完了の切り替え）。
  - **重要**: チェックボックスを操作したカードが**選択モード**になる。
  - 他のカードが選択・編集・追加モードだった場合、それらの操作は**キャンセル**（または終了）され、通常モードに戻る。
    - 編集モードの場合：編集はキャンセルされる。
    - 追加モードの場合：追加はキャンセルされ、入力カードは削除される。

### 通常モード
- **カード部分をクリック**: そのカードが**選択モード**に移行する。
- **マウスホバー**: 背景色が変化する。
- **カード間の追加ボタン (+) クリック**: その位置に新しいタスクを追加する（**追加モード**へ移行）。

### 選択モード
- **カード部分をクリック**: **編集モード**へ移行する。
- **カード外をクリック**: 選択が解除され、**通常モード**に戻る。
- **編集ボタン (✎) クリック**: **編集モード**へ移行する。
- **削除ボタン (🗑) クリック**: タスクを削除する。

### 編集モード
- **保存ボタン (✓) クリック**: 変更を保存し、**選択モード**に戻る。
- **キャンセルボタン (✕) クリック**: 変更を破棄し、**選択モード**に戻る。
- **カード外をクリック**: 変更をキャンセルして**通常モード**に戻る。

### 追加モード
- **保存ボタン (✓) クリック**: タスクを追加し、追加されたタスクが**選択モード**になる。
- **キャンセルボタン (✕) クリック**: 追加をキャンセルし、元の状態に戻る。
- **カード外をクリック**: 追加をキャンセルして閉じる。

---

## キーボード操作による挙動

### 共通
（特になし）

### 通常モード
（特になし、フォーカスが当たるまではキーボード操作不可）

### 選択モード
- **Enter**: **編集モード**へ移行する。
- **Shift + Enter**: チェックボックスのトグル。
- **↑ / ↓**: 前後のタスクへ選択を移動する。
- **Shift + ↑ / ↓**: タスクの順序を入れ替える。
- **Shift + ← / →**: タスクのインデント（レベル）を変更する。
- **Shift + Delete**: タスクを削除する。
- **Esc**: 選択を解除し、**通常モード**に戻る。

### 編集モード
- **Enter**: 変更を保存し、**選択モード**に戻る。
- **Esc**: 変更をキャンセルし、**選択モード**に戻る。

### 追加モード
- **Enter**: タスクを追加し、追加されたタスクが**選択モード**になる。
- **Esc**: 追加をキャンセルし、元の状態に戻る。
